import numpy as np
import rpy2.robjects.numpy2ri
rpy2.robjects.numpy2ri.activate()
import rpy2.robjects.packages as r
import rpy2.robjects as robj

R = rpy2.robjects.r

## ****uncomment these for first try*****
#utils = r.importr("utils")
#pkg_name = "dtw"
#utils.install_packages(pkg_name)
DTW = r.importr('dtw')


# Generate our data
def findTrajectoryDeviation(x, y, z):
    template = np.vstack((x,y,z)).transpose()
    #print(query)
    rt,ct = template.shape

    x_query = [0, -0.23192341758534737, -0.40783179046650936, -0.6444793269318836, -0.7202049241999997, -0.9156042598211426, -1.0672285261154, -1.1675476763880832, -2.116281984133063, -2.215288343534163, -2.2816491273242003, -2.4233290669671446, -2.59641191423915, -2.59641191423915, -2.59641191423915, -2.666856636569043, -2.857958785570904, -3.0842206880404692, -3.225829387147419, -3.3634449273046183, -3.5030117853177782, -3.6430855874190886, -3.844646835017765, -3.644664645597575, -3.644664645597575, -6.513753444674954, -6.6265049896941495, -6.825347192097248, -7.016939130152083, -7.069142294727746, -7.219905220324494, -7.32546683509921, -7.32546683509921, -7.417865459127062, -7.506611933630464, -7.506611933630464, -7.587358512914181, -7.008993775542063, -7.1170201787793825, -7.234087586806933, -7.361868763322675, -7.523067909472279, -7.649380481321706, -7.823874876656436, -7.923781823257393, -8.088130758414215, -8.088130758414215, -8.274536827299814, -8.389463258465547, -8.62424874693399, -8.760329092183303, -8.914426603146294, -8.940961479030388, -9.100435869434746, -9.171751060790209, -9.30483063263229, -9.442217353821139, -9.442217353821139, -10.14218123458549, -10.200013514576861, -10.358582163089558, -10.51228632654289, -10.620980642091121, -10.706915539188184, -10.794986977043095, -10.968170225059287, -11.077433175911967, -11.218126376600626, -11.218126376600626, -11.343792956385897, -11.472491330138462, -11.661884816544292, -11.776913530597232, -12.00734190000033, -12.214842018895755, -12.392791056770232, -12.538905127849373, -12.631297255957668, -12.768349015783945, -12.768349015783945, -12.909783071417491, -12.966848529061252, -13.083378281135792, -13.188340403095262, -13.289681962626227, -13.417990591782656, -13.5228035599912, -13.626462552574559, -13.786138537759758, -13.864933749119334, -21.1330367643033, -20.806365651714895, -20.646904484249784, -19.754945866577906, -18.866118339887382, -17.971305661850973, -17.010912222021428, -16.121425546652816, -15.25079051975134, -14.1543577783106, -13.407541896701035, -13.407541896701035, -12.59585467064204, -12.114272035745001, -11.218744627781119, -10.215399951387035, -9.321453614432244, -8.432154137853765, -7.473244924289795, -6.617868544932799, -5.592190409701661, -4.7080933973543235, -4.7080933973543235, -4.47960904876054, -2.354603143382292, -2.467830489206919, -3.0805003058505043, -3.74079211854661, -4.445131555219916, -5.062792461783215, -5.715089304514311, -6.271510841900497, -6.904280832697141, -7.511226497359402, -6.899531235498686, -7.278818600956125, -7.66675140368317, -8.579128264135576, -9.508887136244924, -10.344152695022917, -11.182712917729644, -11.936016653904629, -12.853637078460649, -13.724178524832151, -14.589575336349926, -14.589575336349926, -15.626515914605358, -15.9437120894222, -16.81542908403415, -17.608290656158925, -18.57368595152435, -19.3885322710935, -20.214186834066908, -21.050337921792902, -21.84719996980876, -22.70438093552314, -22.70438093552314, -23.038783357936925, -23.38135635790379, -24.245391529197327, -25.064659888736163, -25.926008887751088, -26.8067274129892, -27.64552485848768, -28.553579211822992, -29.380167892401555, -30.242192596499148, -30.242192596499148, -30.637745087930785, -30.90864776549665, -31.9185532647191, -32.75766055145185, -33.61964167342798, -34.47608258585549, -35.377443397470515, -36.210317451623624, -37.06887202710687, -37.912839574806576, -37.912839574806576, -37.9883636882533, -38.16598946055876, -38.822856853597315, -39.487104881327454, -40.11562439616085, -40.787585782784035, -41.448708940154454, -42.05004394855597, -42.67268778565963, -43.29864926021957, -43.29864926021957, -43.287974740202856, -43.883846635316715, -44.287528431641995, -44.713996218944295, -45.120420494155994, -45.50409452813285, -45.89778282495565, -46.2871076649395, -46.703399011093346, -47.12498549551222, -47.12498549551222, -47.41338994861338, -48.12952383784503, -48.52278109545255, -48.890008142194006, -49.296056388686104, -49.685986405348636, -50.08579230441003, -50.468838228797054, -50.9100875843989, -51.3087613395727, -51.3087613395727, -51.641790576090045, -51.943345034791236, -52.36029179493658, -52.77726456980291, -53.12763090750909, -53.538209193688786, -53.94694136174828, -54.32246166776408, -54.72108492270935, -55.13688373736273, -55.13688373736273, -55.30775532994118, -55.94830183895018, -56.353461311011486, -56.763299784132606, -57.16643603582429, -57.55147024922914, -57.965121191873735, -58.38368329346769, -58.670605802417185, -59.12615960886089, -59.12615960886089, -60.44108536937397, -61.09098037958646, -61.637341654623775, -62.30986498389939, -62.93699784947769, -63.525436474078724, -64.08808203629306, -64.72971004412076, -65.35919827786347, -65.59681105565605, -66.16413378906465, -66.58958523381432, -67.54290965763364, -68.3978632855556, -69.32206349467972, -70.22159363097506, -71.11805655605741, -72.01170535084651, -72.97310044263062, -73.81831653747278, -73.81831653747278, -74.6967870208049, -74.95610503965236, -75.93207415809673, -77.16382393107101, -78.00870518098209, -78.87281719811484, -80.35291720271539, -81.08834713728116, -81.2404422935423, -82.154984845102, -82.95552033104107, -83.83348244015006, -84.61856618793702, -85.552150495274, -86.43784108892787, -87.25055377036252, -87.25055377036252, -87.85885738100416, -88.71724674326056, -89.56148411570969, -90.46806377797954, -91.32697395894883, -92.20000564218634, -93.14792164772908, -93.97187788951898, -95.22964648246104, -95.5997152354204, -95.9361336180046, -96.82249933292653, -97.72988572279154, -98.57403541082691, -99.45929198747667, -99.45929198747667, -99.45929198747667, -99.60951185255112, -100.45737297946289, -101.30419090233451, -102.11980569961109, -102.97844654404888, -104.65218209968825, -105.87359994963451, -106.20500607306236, -107.10014719065597, -107.95201675576548, -108.86525918598623, -109.75009093710882, -110.58842941958459, -111.3780040334253, -111.3780040334253, -111.3780040334253, -111.928907148673, -112.80798640487544, -113.66820794747092, -114.5553918336177, -115.40853034647004, -116.25903445263269, -117.16439804172121, -117.16439804172121, -117.16439804172121, -117.6592857737786, -118.49685896033596, -119.37323012004913, -120.2708587579661, -121.1295074467667, -122.1129500733143, -123.10011331772282, -123.89901242208576, -125.04464141787273, -127.05607374760814, -127.05607374760814, -127.46686022762889, -128.32141225974527, -129.32655019034405, -130.05070128836473, -131.25706378512254, -132.21703513497926, -132.21703513497926, -132.56094235769524, -133.73054293856123, -134.66601344332258, -135.60059439097415, -136.4921308088647, -137.4242120724209, -138.3985017426964, -138.3985017426964, -139.37810990391478, -140.8756934585785, -141.76792648605857, -142.67600529818478, -143.5828634740112, -144.48995719561893, -145.33931204195233, -146.23143464688238, -146.18523938600677, -146.4355273076814, -146.3926605930299, -146.34739338695195, -146.29332393637992, -146.22343094978973, -146.17010999078238, -146.112178078903, -146.07837140928575, -145.98180664114295, -145.9564983258045, -145.96321421044738, -145.937694952354, -145.94097515884877, -145.90780054488044, -145.8892509878505, -145.84367198796198, -145.84824445971176, -145.8226098734973, -145.7402881355353, -145.74686884976768, -145.6056953878999, -145.611798147515, -145.5937232726551, -145.59259100797505, -145.61441796712646, -145.60686870234431, -145.60740603069388, -145.5624444501654, -145.58538642224434, -145.5730099614939, -145.5730099614939, -145.72917783810493, -145.81157080855894, -145.8759635233193, -145.9687501785832, -146.05314842153996, -146.1597787457962, -146.27675642253183, -146.37657603509274, -146.43458915185218, -146.54809787253487, -146.54809787253487, -146.6080706887071, -146.71524721396085, -146.79598822278712, -146.90318266263102, -146.97271535800448, -147.0692648904019, -147.17283615594164, -147.26366648104764, -147.26366648104764, -147.26366648104764, -147.37429458307358, -147.4850590538908, -147.58115447215098, -147.64531201038287, -147.71862971164987, -147.71301287086163, -147.71301287086163, -147.82629123043498, -147.9393935780637, -147.9393935780637, -148.02762004370334, -148.14056949221543, -148.24208876240093, -148.34402572985397, -148.46492012409465, -148.58053355237618, -148.58053355237618, -148.76747598483325, -148.8235139709185, -148.89023000208238, -148.9558399905477, -149.04725566681424, -149.14027401881262, -149.22509625422092, -149.29480185211392, -149.36208183189694, -149.44178745722485, -149.53197716993472, -150.3343661900655, -150.47960728912722, -150.5318740813794, -150.6208123044843, -150.69178250576002, -150.75181805518542, -150.84384961991515, -150.94346044818647, -151.0281281177014, -151.1317795604502, -151.20731679107314, -151.20731679107314, -151.0720937884723, -151.32624704336237, -151.47637208017275, -151.64773295394212, -151.8026793792543, -151.95217521823088, -152.11922114051916, -152.2749243827739, -152.45338960513737, -152.581200534769, -152.581200534769, -152.24688158437456, -152.31412511025766, -152.4454837003118, -152.57139450462884, -152.7078590545152, -152.84084728825582, -152.9911686561002, -153.1154189034367, -153.2294407770981, -153.38071828101337, -153.38071828101337, -153.44435166353333, -153.68075122371928, -153.79631318907386, -153.85877363182274, -153.9627078359038, -154.0778132864767, -154.16140733934358, -154.22891806304037, -154.22891806304037, -154.32148911125918, -154.3953916694248, -154.50173440589435, -154.56411636550482, -154.6826970472803, -154.7917541258337, -155.31799938963456, -155.31799938963456, -155.31799938963456, -155.36910624027533, -155.46715305542872, -155.59828368358325, -155.6904267404386, -155.7680436049431, -157.02287634711914, -157.02287634711914, -157.55404495825346, -157.84202944974803, -158.0286580893121, -158.23910423927458, -158.4502661906603, -158.65634084159018, -158.84779511975236, -158.84779511975236, -158.84779511975236, -159.06038422328223, -159.28740924185976, -159.52087774200302, -159.85707435374167, -160.0384266915848, -160.26887509515754, -160.4578238011684, -160.65682552837012, -160.8858479735027, -161.39082254696123, -161.39082254696123, -161.67790975599388, -161.8739221575671, -161.99534473650715, -162.168912312885, -162.30710713793903, -162.50456690445367, -162.5656001827976, -162.75565428325984, -162.75565428325984, -162.84819315811404, -162.9334495097608, -162.96167063682006, -163.11327466535135, -163.2688834814905, -163.44948999887797, -163.6067814531136, -163.6067814531136, -163.79305838798768, -163.87907804221078, -164.0519633362276, -164.19676794280176, -164.31117368559896, -164.56079437774233, -164.8913351891699, -167.06876400235504, -167.06876400235504, -167.1115527801082, -167.13584427189588, -167.20452886084885, -167.34900592213805, -167.49749592574216, -167.57195089299384, -167.88164539599657, -167.88164539599657, -165.53049684416274, -165.06564003219458, -164.583199107035, -164.09775058924615, -163.61359598607208, -163.13370458783857, -162.70972622842382, -162.62521957041227, -162.62521957041227, -155.96085654518433, -155.19961360043877, -154.39130802564915, -153.6511577476902, -152.86908348016024, -152.13785088317144, -152.13785088317144, -151.90344905968567, -149.18647716311696, -148.37853638597602, -147.57796796012272, -146.8238052859498, -146.07945782740546, -145.30903512662636, -145.1076041342949, -145.1076041342949, -143.35072885121312, -142.51526133810196, -141.7607697431558, -141.10377474951602, -140.31861621162125, -139.53489109702872, -138.77787169027323, -137.9802996937944, -137.30238861309076, -137.30238861309076, -137.30238861309076, -131.64834920044726, -130.85135418260145, -130.04403221415515, -129.26857208973496, -128.46175671192526, -127.6780950207896, -126.93785229215626, -126.93785229215626, -126.1087759993682, -126.1087759993682, -125.68448918234179, -125.43574674848412, -124.77870705091468, -123.98649986157123, -123.37532441584041, -122.64730431450597, -121.98975397155002, -121.33924647660847, -121.33924647660847, -120.34551122043004, -120.22837658084505, -119.98862167805098, -119.77540982223849, -119.63824342354967, -119.3627167875844, -119.16799452208411, -118.97403386743132, -118.78222299275795, -119.0601491940217, -119.0601491940217, -118.91170330442013, -118.71771153419496, -118.52175382231002, -118.3291292458236, -118.088406622826, -117.87739197318523, -117.738669527417, -117.6182586281438, -116.62062429031778, -116.45019136806226]
    y_query = [0, -0.05749601942140958, -0.1502645888844027, -0.25830657061242196, -0.3060271194210458, -0.3931416741067374, -0.496424420717736, -0.5895055662929372, -0.64701300942962, -0.7424661172995135, -0.8313015036060161, -0.9208396925350152, -1.0055345628557353, -1.0055345628557353, -1.0055345628557353, -1.0570613968487426, -1.1669572932973509, -1.2387045640252372, -1.3200322935238626, -1.406615742445619, -1.4942578566217684, -1.5793205790561262, -1.679556240016562, -1.8166157421829676, -1.8166157421829676, -1.8619500901539845, -1.936602860944736, -2.05019710307911, -2.183718653061369, -2.2782133216017497, -2.3909524068736308, -2.53347059788812, -2.53347059788812, -2.6307331628633333, -2.744999444540606, -2.744999444540606, -2.812895994061542, -3.18665453790263, -3.342980066042587, -3.4565734759691145, -3.5812686441252675, -3.7090108586973116, -3.8365021678469584, -3.979785444461884, -4.118088394606895, -4.2592159242097, -4.2592159242097, -4.740208209411924, -4.842384454807284, -4.962743943375228, -5.099577381767216, -5.244149222962286, -5.3559032943762634, -5.486248132848949, -5.5990156069758905, -5.727335501639322, -5.862849510390797, -5.862849510390797, -6.219503916383566, -6.289957304769615, -6.442494428723993, -6.620200610487976, -6.773322448175062, -6.932130779508021, -7.103703257180358, -7.26855265824248, -7.410958466017828, -7.565891868063626, -7.565891868063626, -7.78111723761316, -7.917462115229688, -8.119992020640202, -8.315328880284849, -8.502619950850317, -8.675460614042564, -8.872709462370644, -9.060808230155672, -9.239741406942523, -9.42316936570887, -9.42316936570887, -9.541952833610454, -9.610657096772293, -9.825420261048375, -10.021404647870279, -10.210590748191898, -10.414799205137735, -10.614184256829406, -10.800567669232374, -11.012763756521569, -11.212087540086166, -12.162243073349282, -12.681867373165396, -12.688439692353516, -12.728600488915152, -12.757079902186367, -12.753117898299505, -12.80462533498194, -12.813765311745213, -12.791132001336395, -12.871353986261713, -12.797884603393339, -12.797884603393339, -12.740631755132004, -12.737999301957919, -12.714871243086334, -12.687968756340574, -12.717707503066661, -12.643507277089018, -12.622948520931013, -12.733859396169361, -12.734042445483249, -12.710920440282566, -12.710920440282566, -12.707726325009176, -13.70572689021129, -13.73362967860126, -13.830693123950764, -13.834814062390267, -13.949168028848677, -14.074776534794097, -14.191677578836378, -14.433955907683096, -14.601742313652593, -14.763769768877262, -18.25731042700657, -18.259482912275452, -18.351580572759147, -18.439780888160108, -18.537891427120464, -18.739002646925737, -18.8758386567551, -18.393407564306752, -18.534132155042133, -18.64235300522136, -18.808062186957585, -18.808062186957585, -18.962862030668216, -19.029644880875768, -19.078218553858196, -19.08365341139752, -19.22358790365128, -19.390782662824023, -19.576469497126322, -19.68494899811211, -19.71551404094371, -19.83725050894791, -19.83725050894791, -19.884265118238574, -19.928057426681466, -19.999373920740414, -20.121606562082853, -20.196245096526745, -20.35507397094245, -20.549689369983138, -20.69910838061867, -20.821251172462844, -20.954648876759435, -20.954648876759435, -20.999806215562398, -21.087163538912968, -21.290340140606382, -21.392391675215727, -21.557320083797016, -21.65798745654356, -21.795088409097165, -21.964924806547327, -22.10561583082145, -22.12815422336717, -22.12815422336717, -23.288378855516285, -23.366837887726582, -23.675531523441812, -23.884930746972262, -24.167250002927705, -24.464376722959123, -24.799094345850484, -25.05731439909155, -25.355183593336346, -25.608480320820757, -25.608480320820757, -25.899065671860743, -26.68769490028967, -27.253060649869518, -27.828280366282385, -28.379037914339186, -28.905180966408558, -29.454881732652836, -30.000979518604062, -30.57204180040889, -31.119534354192943, -31.119534354192943, -31.662870330353734, -32.699798502498986, -33.25008965195302, -33.78639631533637, -34.371816821884046, -34.933657586663195, -35.513078717342836, -36.039095573434835, -36.7215285508417, -37.2915462626427, -37.2915462626427, -37.88928676379897, -38.33755574003872, -38.95368224073341, -39.579491761616126, -40.08529043756598, -40.66807200042895, -41.31655969917948, -41.93942443248404, -42.52299433783539, -43.137521467272265, -43.137521467272265, -43.46464957188067, -44.49306257429623, -45.11486836604493, -45.76742952536101, -46.36654845032658, -46.937100190816984, -47.757708705752925, -48.46336473675965, -48.45267615679835, -48.119210494000434, -48.119210494000434, -47.204377506136474, -46.7302924199525, -46.44039373818127, -45.93529272279896, -45.46098044437216, -45.048440155211836, -44.73689282238619, -44.28257187977427, -43.84781921696107, -43.40274309922129, -43.03019169770221, -42.84532174745129, -42.46616068229867, -42.131549402241376, -41.743297600534774, -41.3568940727792, -41.026741716095614, -40.66635948467178, -40.249919457974, -39.85510998666407, -39.85510998666407, -39.41363736440557, -39.29991403368138, -38.916345132322235, -38.427158431077224, -38.075555344984096, -37.74129237768491, -35.9336806713221, -35.99149755988859, -35.93171075303403, -35.54326090951898, -35.22723819114875, -34.84969271914468, -34.45185814599471, -34.07637087100578, -33.7208103973399, -33.386741511093604, -33.386741511093604, -32.948107689817625, -32.70318748837526, -32.35853536907218, -32.12235791595236, -31.86147383101765, -31.608778283053436, -31.275909847932343, -30.929470106555385, -26.190685216684724, -26.071132471276126, -25.952597558900724, -25.665571220387623, -25.374429617459054, -25.073763280043373, -24.824492544475756, -24.824492544475756, -24.824492544475756, -24.770661396379165, -24.494331688230147, -24.244275984701225, -23.957918189067563, -23.679860237240064, -23.40762330096199, -22.83595710476775, -22.720007304469615, -22.41029783220769, -22.103724366775815, -21.871087016869247, -21.501428461669178, -21.220415673992747, -20.935952100863357, -20.935952100863357, -20.935952100863357, -20.751511704362628, -20.449536672115066, -20.14218446418063, -19.85796009028857, -19.594205468663297, -19.384781453151195, -19.016726347744367, -19.016726347744367, -19.016726347744367, -18.8522689092218, -18.57361954362571, -18.26836898345264, -17.961778027401326, -17.68247584949398, -17.863723900061675, -17.509145401352818, -17.204853511788375, -16.783394573899674, -16.21320534121086, -16.21320534121086, -16.092559407135596, -15.835717539561672, -15.558000794240694, -15.199409870053833, -14.804204227071471, -14.542257208356252, -14.542257208356252, -14.707244047836163, -14.346496649198572, -14.053877895935495, -13.791049270486143, -13.461241862212509, -13.206990604473113, -12.905678225116393, -12.905678225116393, -12.527617732701863, -12.061389946381142, -11.740727086307295, -11.466536376937063, -11.180257370141591, -10.89288836841672, -10.593441960983851, -10.271760365364871, -8.924579742348, -8.511401853134554, -7.754725644810524, -6.779878649207677, -5.79520727235924, -4.830008602748991, -3.7744105594514865, -2.806381072951116, -1.9055819298397336, -0.8286452494489134, -0.4421191640224062, 0.39436760208031013, 1.4605616509169084, 2.4775962762622887, 3.4629862179635724, 4.416071694747227, 5.367937079909051, 6.283146943392301, 7.264161138663242, 8.147680953968065, 8.942172501372067, 9.825686528260816, 10.382669718489959, 11.36549423231285, 12.322096347893355, 13.277292894932753, 14.37822873721375, 15.362762784498651, 16.25082227147528, 17.418651645126616, 18.354119813456208, 18.354119813456208, 18.966707695477695, 20.134617760049117, 21.09912284454824, 22.08439089798488, 23.139063135082694, 24.08945583403717, 25.034005556639197, 25.982194319936397, 26.952189172576382, 27.958193185181088, 27.958193185181088, 28.582312405141767, 29.98229306421176, 30.951787185793503, 31.905970679156272, 32.88413661052323, 33.844848378583, 34.852271397281584, 35.7760777889881, 35.7760777889881, 35.7760777889881, 37.377521719243866, 38.35180435197719, 39.334492063988606, 40.18877964235339, 41.183445683385536, 42.33171253257898, 42.33171253257898, 43.26430389103038, 44.21138226766503, 44.21138226766503, 45.00304703495922, 45.9862127468202, 46.96193327238992, 47.9326298870445, 48.853850960219695, 49.91542462417711, 49.91542462417711, 51.64955160479248, 52.28344869361027, 53.619448755898695, 54.60210952365208, 55.47548310930344, 56.464906177617706, 57.4334024364229, 58.41354909718726, 59.36725556149033, 60.273084548104684, 61.23752144210144, 61.40496416370716, 62.576034206768554, 63.006688776620386, 63.97403351170331, 64.91726215642005, 65.83481223428672, 66.76934386799462, 67.72722375289968, 68.71767643555299, 69.8315772686512, 70.85250756294501, 70.85250756294501, 71.57561948684639, 73.06578555111666, 73.96333394876582, 74.93543813023162, 75.88559449225794, 76.82877333047485, 77.82660395928525, 78.86606613243544, 79.9530326849728, 80.61887316562952, 80.61887316562952, 81.51277476349297, 82.0072584935651, 82.954110054898, 83.84574340775202, 84.76774670457745, 85.7193499610355, 86.82071274070425, 87.83933376266663, 88.60629329041694, 90.16850094506836, 90.16850094506836, 90.4164621467286, 92.91917014869162, 93.87796069400521, 94.8445462497404, 95.78987612799479, 96.74719701877754, 97.67062197170655, 98.39225751138102, 98.39225751138102, 99.37150884340431, 100.3393364947044, 101.30607069524126, 102.34784096688973, 103.29575611969946, 104.24592629989519, 104.91304177840358, 104.91304177840358, 104.91304177840358, 105.31868321658705, 106.27452654164881, 107.1910784870794, 108.20525789775853, 109.16333767013163, 109.89948613206148, 109.89948613206148, 111.971077441137, 112.89627532080375, 113.85923032049591, 114.80794244149034, 115.75335987731562, 116.68380129516167, 117.5786472501235, 117.5786472501235, 117.5786472501235, 118.16759936186652, 119.09954273084296, 120.03759135043565, 120.90001376646532, 121.86280490909027, 122.83841763741933, 123.78431538214453, 124.72619375158304, 125.65978798708176, 125.75349394607139, 125.75349394607139, 127.30919352561824, 128.28140531855948, 129.23464982738523, 130.29789785902986, 131.27357316670475, 132.27482108250416, 132.61208685976771, 134.19502780164444, 134.19502780164444, 136.3260783503009, 137.30931421815072, 138.29412317010693, 139.39475921234094, 140.32769000886893, 141.27801925865265, 142.23784775960672, 142.23784775960672, 143.10383445482123, 143.75501618934274, 144.71938428904915, 145.69301791923394, 146.56672731762882, 147.5111918883592, 148.30990995857124, 149.514040330325, 149.514040330325, 150.37380210694198, 151.35177323420012, 152.3328100160499, 153.30234797242028, 154.22634102139887, 155.1992908224312, 155.4677738306698, 155.4677738306698, 158.34721135310446, 158.92365264154506, 159.46285861003122, 160.02644954617082, 160.5701345944135, 161.13503960535508, 161.649471367371, 161.4078505316653, 161.4078505316653, 166.21322030997922, 166.73662320440874, 167.28243713377321, 167.87117637583398, 168.46983879038498, 169.05166899277188, 169.05166899277188, 169.19667048267388, 171.17378358875823, 171.71936996729323, 172.33066900767977, 172.9020469743765, 173.43510534516776, 174.0392471836032, 174.1853566197335, 174.1853566197335, 175.4769320071022, 176.09420278986343, 176.69008876633993, 177.27023159499666, 177.85709887443227, 178.41816214102144, 178.95498984736471, 179.44730833590907, 180.0281219554892, 180.0281219554892, 180.0281219554892, 184.49807585842393, 185.05184959797737, 185.59114840924317, 186.16982344757045, 186.72117978461566, 187.26499257794254, 187.79866822074973, 187.79866822074973, 188.3800005894384, 188.3800005894384, 187.79737124567276, 188.01692852761983, 188.4903285068452, 189.19295960579908, 189.77995531249775, 190.4101783054807, 191.0060559498534, 191.59164324268858, 191.59164324268858, 191.23079415550342, 191.70863315653335, 192.3951245884319, 193.0282921977955, 193.79228601005673, 194.44194055177556, 195.19890800890752, 195.88415494604465, 196.55846316345, 197.5116747018438, 197.5116747018438, 198.04006881027362, 198.63209753529904, 199.35468349527255, 200.06987509038217, 200.74983990590403, 201.48445110264134, 202.224032096866, 203.01526516311853, 202.71162228089466, 203.28438151175575]
    z_query = [0, 0.9710333341993084, 2.2139003189610484, 3.5539315344575613, 4.055189718337832, 5.011389214277789, 6.082917818740067, 7.07759714775102, 7.664983847493499, 8.568934261763232, 9.556571783615372, 10.591577622907812, 11.56009089807315, 11.56009089807315, 11.56009089807315, 12.12179177079156, 13.091613955037385, 14.123521251851477, 15.043262626922402, 16.098450933405847, 17.054427776274483, 18.031329422290046, 18.9612313557086, 19.744217047005737, 19.744217047005737, 21.673384822550414, 22.364668602363675, 23.26011644094833, 24.24484079077522, 25.220883449961914, 26.250938880599236, 27.27018702765501, 27.27018702765501, 28.191513998545343, 29.18062766060467, 29.18062766060467, 29.738933820830724, 31.73140071807311, 32.89388458294444, 33.84111146183821, 34.761197692206395, 35.692855703206654, 36.63423712478285, 37.59985917247345, 38.58525919706904, 39.54877120601872, 39.54877120601872, 41.052579009787, 41.78035032436888, 42.69301985743525, 43.605393658321674, 44.622211869057274, 45.57605592512076, 46.55442765884683, 47.46136849293154, 48.42296346358389, 49.41898890496512, 49.41898890496512, 51.20471571583504, 51.64094160199537, 52.64022812759642, 53.629707132441894, 54.60107755429622, 55.5828636293313, 56.54694824954359, 57.52203235365494, 58.449303975934924, 59.480568222968984, 59.480568222968984, 60.502799984684614, 61.244142994612844, 62.235057902912544, 63.18871262686741, 64.13340564212959, 65.07324920871982, 66.02092571069697, 67.0113392220112, 68.05118154735979, 69.05982676811216, 69.05982676811216, 69.54240872190563, 69.90028434274325, 70.93944438116817, 71.88993255519455, 72.86170421052734, 73.84708410421493, 74.8282759578482, 75.77878890195613, 76.73610703164371, 77.70493962668651, 81.96898858472483, 81.85333055555934, 81.93140787637645, 82.37205899689685, 82.81653174768601, 83.28380361625301, 83.76750417327469, 84.21312584377614, 84.68071045747956, 85.16369768419302, 85.58868990406877, 85.58868990406877, 86.17197248907772, 86.39823268644805, 86.81694564731144, 87.30463435479459, 87.69370236040857, 88.14552073073114, 88.59859769948858, 88.92033697985497, 89.35304551388933, 89.76051889970252, 89.76051889970252, 89.87210297807506, 90.01644359758325, 90.16129115300603, 90.87708402081297, 91.59624166258313, 92.43944635269122, 93.21620159167345, 93.96567843501467, 94.76680151607603, 95.57866497501891, 96.34786186680428, 100.65609732099371, 100.35860147146647, 100.09253706112499, 99.52349177801605, 98.93611483846044, 98.40321570201523, 97.86708348968567, 97.49396256368848, 96.8915583920755, 96.35283049917213, 95.8227586912405, 95.8227586912405, 94.96937258870562, 94.77860842848149, 94.26238128530017, 93.75261394594602, 93.15837426268293, 92.6348539598074, 92.11749159662573, 91.60667814914011, 91.11884882450336, 90.57033417615811, 90.57033417615811, 90.33057451361192, 90.11672985145613, 89.59129302272935, 89.09232313160005, 88.55596286698787, 88.02875374012001, 87.49548428849533, 86.93603725506816, 86.42524503747653, 85.88418899958202, 85.88418899958202, 85.59336377935367, 85.43376110566942, 84.82281843098546, 84.30118568508719, 83.75689359927716, 83.24128580251, 82.69231688893625, 82.18167795231422, 81.6457318325524, 81.14073958573043, 81.14073958573043, 79.91351831777217, 79.69990820603553, 78.94090384113571, 78.1602474674063, 77.45391206866579, 76.67161634584808, 75.92143164304692, 75.22380444138284, 74.51460646973389, 73.77161887063818, 73.77161887063818, 73.55151536741828, 72.53354084881519, 71.88207507763076, 71.16265892880361, 70.43792371288744, 69.67147580208531, 68.94818218912704, 68.23620906634876, 67.5456739461607, 66.81134802120489, 66.81134802120489, 65.8676446893617, 64.66147946397399, 63.90787136021189, 63.24166625162526, 62.514605489161596, 61.85296782106461, 61.15023399402817, 60.40488881058529, 59.67405224447059, 58.95558673376844, 58.95558673376844, 58.22387853891978, 57.66795522642179, 57.03319789651568, 56.29526895780296, 55.549574291782974, 54.748342152007005, 53.97662374188879, 53.29731504322224, 52.59475778969615, 51.833417071237676, 51.833417071237676, 51.39450182804816, 50.29458423332356, 49.60350117526639, 48.96236750009157, 48.249342757133164, 47.60389683651919, 47.19239627086986, 46.41192303801107, 46.16787368489202, 45.7429251739045, 45.7429251739045, 44.51574027946048, 43.94192596780637, 43.22877110280759, 42.60149154592416, 41.99355216038286, 41.403235943765495, 40.60697257798313, 39.98333471721314, 39.37339024836872, 39.48414485516695, 39.6751030267506, 39.814330191049855, 40.12188309477436, 40.38318562012467, 40.67211343120535, 40.9652007412866, 41.22337560599765, 41.49673271292694, 41.79698238420623, 42.07678791670324, 42.07678791670324, 42.31875261386977, 42.411382684504474, 42.733159608719966, 43.137548152959475, 43.42571142534836, 43.714389798842525, 44.97719616817985, 44.987411779953064, 45.045276788004365, 45.43001159907088, 45.738202086732095, 46.08341752281012, 46.44616787781678, 46.796779869195504, 47.13191805878141, 47.453236299718085, 47.453236299718085, 47.78046138062029, 48.10802648751399, 48.48193098645202, 48.853775400209834, 49.194705557869874, 49.556053904552925, 49.95793757958331, 50.34284640754019, 53.02643091819119, 53.18880633789198, 53.36164394047129, 53.79519513494625, 54.24024763144282, 54.67034907787952, 55.06760844627155, 55.06760844627155, 55.06760844627155, 55.14368541604523, 55.53959910456172, 55.932533956595044, 56.33720099767011, 56.74401861759162, 57.27154786872896, 57.879157984605136, 58.03010097871052, 58.42721777147202, 58.807590005831884, 59.19382696950318, 59.63543688527926, 59.97126260284403, 60.32461775777845, 60.32461775777845, 60.32461775777845, 60.567152449769516, 60.96880489868428, 61.3578354566326, 61.72674518620653, 62.103273843977824, 62.42649652241212, 62.86594308522741, 62.86594308522741, 62.86594308522741, 63.08219862732212, 63.44768971730773, 63.82793994597881, 64.23496194925116, 64.59960184629848, 64.63392932296168, 65.06777225305031, 65.41755096429716, 66.04503427583779, 66.70618653794973, 66.70618653794973, 66.84251880692051, 67.13333545817994, 67.47405683090102, 67.77583475057843, 68.19690646367052, 68.52763087953036, 68.52763087953036, 68.6268666063224, 68.93628567474626, 69.17662889092051, 69.41767578403119, 69.69263165697474, 69.91602565735353, 70.16847705643599, 70.16847705643599, 70.47380216485888, 70.9293343770508, 71.24323500157554, 71.51209288712847, 71.78420182637859, 72.07576674638563, 72.33678990382711, 72.6250427666128, 72.64506889144506, 72.72125481412567, 72.85557909570777, 73.03050849784275, 73.17533144039268, 73.39723177942686, 73.56124010495635, 73.72491245126785, 73.86249018331353, 74.01259468746552, 74.17715731981632, 74.27011373929962, 74.41390407109473, 74.55274206924948, 74.69095312077506, 74.81863745107906, 74.9707707564371, 75.03514735332138, 75.1602996870154, 75.4193080541045, 75.71652509170545, 76.1966850841121, 76.25518077222588, 76.40411254936859, 76.55544054686698, 76.66046522184602, 76.83878062122585, 76.95913775065549, 77.21452938636472, 77.39566569307908, 77.5335794182869, 77.5335794182869, 77.61409483127598, 77.81172478690841, 78.02403829238673, 78.09649036994404, 78.26970116786502, 78.37637331293656, 78.47946384984418, 78.62292493104432, 78.7931169879353, 78.9192660094947, 78.9192660094947, 79.01775652811621, 79.26743256126605, 79.41332805925276, 79.47822915503777, 79.65337340542217, 79.82659891949936, 79.92238196423443, 80.07480001273711, 80.07480001273711, 80.07480001273711, 80.31931407442637, 80.43596287410207, 80.53992067012645, 80.68173067101564, 80.84907722025714, 81.1373439650727, 81.1373439650727, 81.25833164763088, 81.37994840172016, 81.37994840172016, 81.47125138508797, 81.61995588139773, 81.74152400591578, 81.87721510853117, 82.03186587081207, 82.17350731203352, 82.17350731203352, 82.45334305702661, 82.56305231927124, 82.92825940853174, 83.09342922796186, 83.18630064043782, 83.3150365909163, 83.4632160417143, 83.61542351878089, 83.84395085545431, 84.01132458621066, 84.16140103720848, 83.55556523347593, 83.3631627711027, 83.28856530977599, 83.0846350687753, 82.9341224985263, 82.80589209751373, 82.6636503171694, 82.5157362546592, 82.36215334016804, 82.17998838624183, 82.0282762405049, 82.0282762405049, 82.08114435220463, 81.84604135277822, 81.70121854116763, 81.50383395423087, 81.35070013369909, 81.20689744956061, 81.04437290574029, 80.90273564069862, 80.72880950417006, 80.6166777889644, 80.6166777889644, 81.23935047295454, 81.1200594677541, 80.87339297845487, 80.64121974142849, 80.39508948357413, 80.14705612501719, 79.87181641693071, 79.6239099992207, 79.41809992147193, 79.04776140383886, 79.04776140383886, 78.94411792722553, 78.43012285718967, 78.17637191833765, 77.95377431286487, 77.75187916880529, 77.51734872092801, 77.32332931798427, 77.16525938156909, 77.16525938156909, 76.92154650339641, 76.69887033641915, 76.47255940092867, 76.27823296142583, 76.01363458646335, 75.76016694448022, 75.07278135182665, 75.07278135182665, 75.07278135182665, 74.95663266376445, 74.68326726796504, 74.40826343669693, 74.15842868592723, 73.93432449103449, 71.59892484693256, 71.59892484693256, 72.1241002884595, 72.35392617791554, 72.58919281374173, 72.81413833291778, 73.04057414139892, 73.25522070222301, 73.48009473434428, 73.48009473434428, 73.48009473434428, 73.63075661261945, 73.87659520667334, 74.12238182769391, 74.36061750700833, 74.58461858820827, 74.84207625428863, 75.09300849103225, 75.32464141711031, 75.55982722749623, 76.25183707932761, 76.25183707932761, 76.4751189034601, 76.62249380306612, 76.75003215370013, 76.90723489156026, 77.05814918419257, 77.22943028875666, 77.28413003545973, 77.4813226756103, 77.4813226756103, 77.77009398707506, 77.89528033429748, 78.01177930831058, 78.19935601634451, 78.35309212744815, 78.5012376415857, 78.6674621314552, 78.6674621314552, 78.85080876607843, 78.94000006073468, 79.09859611117857, 79.24480318768667, 79.3629045624511, 79.5355939724551, 79.71584199632437, 81.15429568966776, 81.15429568966776, 81.27785806528502, 81.39180433093554, 81.53560795241702, 81.69365692437978, 81.8624950929094, 82.01991676765273, 81.97372378519417, 81.97372378519417, 85.30433263417221, 85.95380064011847, 86.64483646840952, 87.33378244413406, 88.00218658961272, 88.66285765129739, 89.23467209789028, 89.82438389036038, 89.82438389036038, 88.30076244278997, 88.14654251230611, 87.9675510370164, 87.814200616922, 87.63493187780121, 87.459711631601, 87.459711631601, 87.40792621966759, 86.74871203508508, 86.60138817353359, 86.41222281731133, 86.22992166062015, 86.0584053344261, 85.87511682573312, 85.82556608980325, 85.82556608980325, 85.36913948878806, 85.16023915951658, 84.95084027580727, 84.7506556638132, 84.53511024193762, 84.32903522683789, 84.13958921541986, 83.95703410065931, 83.73566302992349, 83.73566302992349, 83.73566302992349, 82.22060962504548, 82.01719849887633, 81.85009123448064, 81.66098320931202, 81.48734403557815, 81.30531630989027, 81.1216140468747, 81.1216140468747, 80.91590117568818, 80.91590117568818, 80.81284891860659, 80.66496150294553, 80.31826295528064, 79.84056711245239, 79.43238797519658, 78.98665916678488, 78.58846346360667, 78.20830069940097, 78.20830069940097, 78.15495842030822, 77.70763999270204, 77.00322331596351, 76.32588748393759, 75.70095141590544, 74.96812123035181, 74.23421855156232, 73.56273037233564, 72.91003190095728, 72.58510566504674, 72.58510566504674, 72.08418662519908, 71.4932836277381, 70.83381642312958, 70.16035601304431, 69.4622182402966, 68.79451500965118, 68.18125389511535, 67.5816072099675, 66.79313108847772, 66.24858506407162] 
    
    query = np.vstack((x_query, y_query, z_query)).transpose()
    #print(template)
    rq,cq = query.shape

    #converting numpy matrices to R matrices
    templateR=R.matrix(template,nrow=rt,ncol=ct)
    queryR=R.matrix(query,nrow=rq,ncol=cq)

    # Calculate the alignment vector and corresponding distance
    alignment = R.dtw(templateR,queryR,keep=True, step_pattern=DTW.asymmetric,open_begin=True,open_end=True)

    dist = alignment.rx('distance')[0][0]

    print(dist)


#findTrajectoryDeviation([1,2,3,4,5], [1,2,3,4,5], [1,2,3,4,5])
